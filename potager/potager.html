<!doctype html>
<html lang="fr">
	<head>
		<title>le Potager</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width">
		<script type="text/javascript" src="potager.js"></script>
		<link rel="stylesheet" type="text/css" href="potager.css" >
	</head>



<body id="body">
<div id="tour_plateau">
	<div style="height:calc( inherit - 30px ); width:auto;">
		<canvas id="plateau" height="600" width="600"
			oncontextmenu="event.preventDefault(); modi(parseInt(event.offsetX*ns/this.offsetWidth), parseInt(event.offsetY*ns/this.offsetHeight), 2); affi(); info();"
			onclick="modi(parseInt(event.offsetX*ns/this.offsetWidth), parseInt(event.offsetY*ns/this.offsetHeight), 1); affi(); info();"
			>
		</canvas>
	</div>
	<div style="min-height:20px; height:auto;">
		<span class="info_game" id="current_state_0">Temps</span>
		<span class="info_game" id="current_state_1">Jaune</span>
		<span class="info_game" id="current_state_2">Bleu</span>
	</div>
</div>

<div id="tour_tab">
<div id="tabmenu">
	<!--Vim's indent starts here-->
	<button class="tablink" id="b_regles"   onclick="openTab(event, 'regles',   undefined)" style="background:#d3d3d3;">Règles</button>
	<button class="tablink" id="b_opposant" onclick="openTab(event, 'opposant', undefined)">Opposant</button>
	<button class="tablink" id="b_parties"  onclick="openTab(event, 'parties',  undefined)">Parties</button>
	<button class="tablink" id="b_analyse"  onclick="openTab(event, 'analyse',  undefined)">Analyse</button>
</div>

<div id="opposant" class="tabcontent">
	<h3>Choix des joueurs&nbsp;:</h3>
	<p><label for="ia_jaune">Jaune&nbsp;:</label>
	<select name="ia_jaune" id="ia_jaune">
		<optgroup label="Sans optimisation:">
			<option value="0" selected="selected">Humain</option>
			<!--<option value="1">Hasard</option>-->
		</optgroup>

		<optgroup label="Basique, score:">
			<!--<option value="2">Score 1 (glouton)</option>-->
			<!--<option value="3">Score 2 (complet)</option>-->
			<!--<option value="4">Score 3</option>-->
			<!--<option value="5">Score 4 (complet x 2)</option>-->
		</optgroup>

		<optgroup label="Moyen, graines+score:">
			<!--<option value="6">Graine 1 </option>-->
			<!--<option value="7">Graine 2 (complet)</option>-->
			<!--<option value="8">Graine 3</option>-->
			<!--<option value="9">Graine 4 (complet x 2)</option>-->
		</optgroup>
	</select></p>

	<p><label for="ia_bleue">Bleu&nbsp;:&nbsp;</label>
	<select name="ia_bleue" id="ia_bleue">
		<optgroup label="Sans optimisation:">
			<option value="0">Humain</option>
			<option value="1">Hasard</option>
		</optgroup>

		<optgroup label="Basique, score:">
			<!--<option value="2">Score 1 (glouton)</option>-->
			<!--<option value="3">Score 2 (complet)</option>-->
			<!--<option value="4">Score 3</option>-->
			<!--<option value="5">Score 4 (complet x 2)</option>-->
		</optgroup>

		<optgroup label="Moyen, graines+score:">
			<option value="6">Graine 1 </option>
			<option value="7" selected="selected">Graine 2 (complet)</option>
			<!--<option value="8">Graine 3</option>-->
			<!--<option value="9">Graine 4 (complet x 2)</option>-->
		</optgroup>
	</select></p>

	<h3>Description des IA&nbsp;:</h3>
	<p><em>Humain   &nbsp;:</em> n'est pas une IA, permet de jouer seul ou avec quelqu'un présent dans la même pièce que vous.</p>
	<p><em>Hasard   &nbsp;:</em> peut jouer pratiquement n'importe quel coup, avec une préférence pour sa couleur.</p>
	<p><em>Score X  &nbsp;:</em> regarde toutes les possibilités sur les X prochains tours (temps de calcul exponentiel) et prend celle maximisant son score.</p>
	<p><em>Graines X&nbsp;:</em> comme <em>Score X</em> mais cherche en priorité à maximiser le nombre de graines d'avance, et le score seulement en cas d'égalité</p>
	<p>Pour l'instant, seul <em>Humain</em> fonctionne pour Jaune.<br/>
	<em>Humain</em>, <em>Random</em>, <em>Graine 1</em> et <em>Graine 2</em> fonctionnent pour Bleu.</p>
</div>

<div id="parties" class="tabcontent">
	<input type="button" class="b_option" value="Oublier"     title="[Q] Efface la partie de l'historique." onclick="document.getElementById('game_summary').value=''; game_forget(); affi();">
	<input type="button" class="b_option" value="Nouveau"     title="[G] Sauvegarde et réinitialise." onclick="game_export(); init(); affi()">
	<input type="button" class="b_option" value="Précédant"   title="[T] Partie jouée précédante." onclick="game_prev(); game_export(); affi();">
	<input type="button" class="b_option" value="Suivant"     title="[N] Partie jouée suivante." onclick="game_next(); game_export(); affi();">
	<input type="button" class="b_option" value="Sauvegarder" title="[S] Affiche ici (texte, JSON) le compte-rendu de la partie actuelle" onclick="game_export()">
	<input type="button" class="b_option" value="Charger"     title="[M] Quitte. Joue avec la partie ci-dessous" onclick="game_import(); affi()"><br/><br/>

	<textarea
		name="game_summary"
		id="game_summary"
		cols="40"
		rows="5"
		placeholder="Texte au format JSON"
		style="width:99%; height:160px; max-height:45%; font-size:70%;"
		>
	</textarea>
		<label for="game_summary">Copiez les données pour archiver votre partie.</label>
</div>

<div id="analyse" class="tabcontent">
	<input type="button" class="b_option" value="Début"   title="[C] Vide le plateau, mais les actions sont mémorisées" onclick="card_begin(true); affi()">
	<input type="button" class="b_option" value="Fin"     title="[L] Va au coup enregistré le plus récent" onclick="card_end(true); affi()">
	<input type="button" class="b_option" value="Annuler" title="[T] [Ctrl-Z] Remonte le temps d'un tour" onclick="card_undo(true); affi()">
	<input type="button" class="b_option" value="Refaire" title="[N] [Ctrl-Y] Annule l'annulation" onclick="card_redo(true); affi()">
	<input type="button" class="b_option" value="Temps"   title="[G] Aller à un tour précis" onclick="card_temps(parseInt(prompt('Aller au tour&nbsp;:', '0'))); affi()">
	<input type="button" class="b_option" value="Vidéo"   title="[Espace] Visualise la partie en accéléré" onclick="card_video()">
	<p class="wtp">Revenir en arrière, visualiser la partie</p>
</div>

<div id="regles" class="tabcontent" style="display:block !important;">
	<h2>Le potager</h2>
	<p><span>Ce jeu peut se jouer sur un plateau carré de&nbsp;</span>
	<span>
		<input type="button" class="rule_button" value="3"  title="Nouvelle partie, taille 3"  onclick="n_s=3;  init(); affi()">,
		<input type="button" class="rule_button" value="5"  title="Nouvelle partie, taille 5"  onclick="n_s=5;  init(); affi()">,
		<input type="button" class="rule_button" value="8"  title="Nouvelle partie, taille 8"  onclick="n_s=8;  init(); affi()"> ou
		<input type="button" class="rule_button" value="13" title="Nouvelle partie, taille 13" onclick="n_s=13; init(); affi()">
	</span>
	<span> cases de côté.</span></p>

	<h2>Règles&nbsp;:</h2>

	<h3>But du jeu&nbsp;:</h3>
	<p>Deux jardiniers doivent se partager un même potager. L'un plante des
	aubergines (bleu) et l'autre des patates (jaune). Chacun veut occuper
	le maximum de cases à la fin de la saison.</p>

	<p>Une fin de saison advient lorsqu'on ne peut plus jouer, même s'il
	reste des cases disponibles. On fait alors le compte des cases 
	occupées par chacun et en cas d'égalité, c'est le joueur dont c'était
	le tour et qui n'a pas pu jouer qui perd.</p>

	<h3>Démarrage de la saison&nbsp;:</h3>
	<p>Le bac à compost constitue la pioche. On élabore ses plantations à
	partir du compost. Lorsqu'une carte est supprimée elle retourne au
	compost. Le bac à compost contient&nbsp;: des cartes rectangulaires de 1,
	2, 3, 5, 8 et 13 cases de long (elles font toutes une case de
	large).</p>

	<p>Le jardinier qui joue en premier pose obligatoirement une « graine »
	(c'est-à-dire la plus petite carte, avec un seul point). Ensuite le
	deuxième joueur joue deux fois, et à partir de là chaque joueur jouera
	toujours deux fois consécutivement à son tour (tant que c'est
	possible).</p>

	<h3>Pour planter au potager il y a 3 règles à respecter&nbsp;:</h3>

	<h4>Diversité</h4>
	Deux cartes de même taille ET de même couleur ne doivent jamais se
	toucher. Seul les contacts entre cartes verticales ou horizontales
	comptent. Les diagonales ne comptent pas. Cette affirmation vaut pour
	toute les règles.<br/> <br/>

	<img src="divers.png" alt="exemples interdictions">

	<h4>Semis</h4>
	<p>Pour poser une parcelle, il faut qu'elle touche suffisemment de graines, de la même couleur.
	Plus une parcelle est grande, plus il faudra de graines&nbsp;:</p>

	<table style="border:3px solid white; align:center">
		<tr> <th>Parcelle<br/>à poser</th> <th>Graines<br/>nécessaires</th> </tr>
		<tr> <td>2 cases </td> <td>1 graine </td> </tr>
		<tr> <td>3 cases </td> <td>2 graines</td> </tr>
		<tr> <td>5 cases </td> <td>3 graines</td> </tr>
		<tr> <td>8 cases </td> <td>4 graines</td> </tr>
		<tr> <td>13 cases</td> <td>5 graines</td> </tr>
	</table>

	<p>Donc autant de graines qu'il y a de tailles de cartes plus petites.</p>

	<img src="semis_b.png" alt="3 graines">&emsp;
	<img src="semis_e.png" alt="3 graines, une parcelle">

	<h4>Remplacement</h4>
	<p>On peut poser une carte par-dessus les autres, seulement si elle est
	plus grande que chaque carte qu'elle recouvre individuellement. Poser
	par-dessus, supprime ce qui est en dessous. Pas
	besoin de recouvrir la totalité de la carte (il suffit d'une case)
	pour l'envoyer au compost.</p> <br/>

	<img src="remplace_b.png" alt="3 graines, autres">&emsp;
	<img src="remplace_e.png" alt="3 graines, une parcelle_5"> <br/>

	<p>Une carte posée ne peut pas dépasser du plateau. De ce fait une carte
	13 (ou de la taille du plateau s'il est plus petit), une fois posée,
	ne peux pas être renvoyée au compost, car elle est la plus grande.</p>
	Bon Jardinage !

	<h3>Particularité&nbsp;:</h3>
	<p>Il est permis à tout moment de jouer une carte n'étant pas de sa couleur.
	Cette règle est surtout intéressante lorsque les possibilités d'actions sont restreintes
	(milieu ou fin de partie).</p> <br/> <br/> <br/> <br/> <br/>

	<h3>Commandes&nbsp;:</h3>
	<p>Le plateau est initialement vide. Pour réinitialiser et choisir la taille du plateau,
	cliquez sur les boutons 3, 5, 8, 13 en haut de la notice.</p>

	<p>La couleur du tour du plateau indique qui doit jouer. Si la partie est terminée,
	le quadrillage se met de la couleur du gagnant.</p>

	<p>Pour poser une carte, il faut cliquer sur les deux extrêmités de celle-ci.
	S'il s'agit d'une graine, il faudra seulement cliquer deux fois sur la même case.
	Après un premier clic, toutes les cases correspondant à une action valide
	sont représentées en rouge.</p>

	<img src="clic.png" alt="3 graines, autres">&emsp;
	<img src="clic_bis.png" alt="3 graines, autres">

	<p>Clic gauche&nbsp;: joue pour soi. S'il y a des cases rouges&nbsp;: valide.<br/>
	Clic droit&nbsp;: joue pour l'autre. S'il y a des cases rouges&nbsp;: annule.</p>

	<p>Les cases rouges apparaissent uniquement s'il y a plusieurs possibilités.<br/>
	Si vous faites une erreur (premier clic qui ne permet pas de poser),
	l'ensemble des cases valides sera temporairement affiché en marron.</p> <br/> <br/> <br/>
</div>
</div>

<script>
	init(); affi();
</script>

</body>
</html>
